"use strict";var cov_wb9ggqkm4=function(){var a=new Function("return this")(),b="__coverage__",c=a[b]||(a[b]={});return c["/home/wasif/projects/fastify-mongoose-connection/src/connect.js"]&&c["/home/wasif/projects/fastify-mongoose-connection/src/connect.js"].hash==="dfb96ea8d9089cd0c6e36c2a4afdea38bfba61d4"?c["/home/wasif/projects/fastify-mongoose-connection/src/connect.js"]:c["/home/wasif/projects/fastify-mongoose-connection/src/connect.js"]={path:"/home/wasif/projects/fastify-mongoose-connection/src/connect.js",statementMap:{0:{start:{line:5,column:16},end:{line:56,column:1}},1:{start:{line:14,column:8},end:{line:14,column:14}},2:{start:{line:17,column:23},end:{line:17,column:49}},3:{start:{line:20,column:4},end:{line:20,column:27}},4:{start:{line:23,column:4},end:{line:23,column:35}},5:{start:{line:26,column:4},end:{line:29,column:5}},6:{start:{line:27,column:8},end:{line:27,column:57}},7:{start:{line:28,column:8},end:{line:28,column:21}},8:{start:{line:31,column:4},end:{line:31,column:27}},9:{start:{line:34,column:4},end:{line:37,column:5}},10:{start:{line:35,column:8},end:{line:35,column:69}},11:{start:{line:36,column:8},end:{line:36,column:21}},12:{start:{line:39,column:4},end:{line:41,column:5}},13:{start:{line:40,column:8},end:{line:40,column:51}},14:{start:{line:44,column:4},end:{line:46,column:5}},15:{start:{line:45,column:8},end:{line:45,column:43}},16:{start:{line:49,column:4},end:{line:55,column:32}},17:{start:{line:52,column:12},end:{line:52,column:41}},18:{start:{line:53,column:12},end:{line:53,column:29}},19:{start:{line:55,column:22},end:{line:55,column:31}}},fnMap:{0:{name:"(anonymous_0)",decl:{start:{line:5,column:16},end:{line:5,column:17}},loc:{start:{line:5,column:43},end:{line:56,column:1}},line:5},1:{name:"(anonymous_1)",decl:{start:{line:51,column:14},end:{line:51,column:15}},loc:{start:{line:51,column:24},end:{line:54,column:9}},line:51},2:{name:"(anonymous_2)",decl:{start:{line:55,column:15},end:{line:55,column:16}},loc:{start:{line:55,column:22},end:{line:55,column:31}},line:55}},branchMap:{0:{loc:{start:{line:26,column:4},end:{line:29,column:5}},type:"if",locations:[{start:{line:26,column:4},end:{line:29,column:5}},{start:{line:26,column:4},end:{line:29,column:5}}],line:26},1:{loc:{start:{line:34,column:4},end:{line:37,column:5}},type:"if",locations:[{start:{line:34,column:4},end:{line:37,column:5}},{start:{line:34,column:4},end:{line:37,column:5}}],line:34}},s:{0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0,14:0,15:0,16:0,17:0,18:0,19:0},f:{0:0,1:0,2:0},b:{0:[0,0],1:[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"dfb96ea8d9089cd0c6e36c2a4afdea38bfba61d4"}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _connection=require("./connection"),_host=require("./host"),_helpers=require("./helpers");cov_wb9ggqkm4.s[0]++;const connect=(a,b,c)=>{cov_wb9ggqkm4.f[0]++;// extract configs
const{user:d,password:e,name:f,hosts:g,options:h}=(cov_wb9ggqkm4.s[1]++,b),i=(cov_wb9ggqkm4.s[2]++,_connection.ConnectionFactory.create());// create the connection instance
// set db name for the connection
if(cov_wb9ggqkm4.s[3]++,i.user=d,cov_wb9ggqkm4.s[4]++,i.password=e,cov_wb9ggqkm4.s[5]++,!f)return cov_wb9ggqkm4.b[0][0]++,cov_wb9ggqkm4.s[6]++,c(new Error("should provide database name.")),cov_wb9ggqkm4.s[7]++,!1;// add all the hostss
if(cov_wb9ggqkm4.b[0][1]++,cov_wb9ggqkm4.s[8]++,i.name=f,cov_wb9ggqkm4.s[9]++,!g)return cov_wb9ggqkm4.b[1][0]++,cov_wb9ggqkm4.s[10]++,c(new Error("should provide at lease one host details.")),cov_wb9ggqkm4.s[11]++,!1;cov_wb9ggqkm4.b[1][1]++,cov_wb9ggqkm4.s[12]++;for(const{host:d,port:e}of(0,_helpers.toArray)(g))cov_wb9ggqkm4.s[13]++,i.hosts.add(new _host.Host(d,e));// set all options
cov_wb9ggqkm4.s[14]++;for(const[d,e]of Object.entries(h))cov_wb9ggqkm4.s[15]++,i.options.set(d,e);// establish the connection
cov_wb9ggqkm4.s[16]++,i.connect().then(b=>{cov_wb9ggqkm4.f[1]++,cov_wb9ggqkm4.s[17]++,a.decorate("db",b),cov_wb9ggqkm4.s[18]++,c(null,b)}).catch(a=>(cov_wb9ggqkm4.f[2]++,cov_wb9ggqkm4.s[19]++,c(a)))};var _default=connect;exports.default=_default;
//# sourceMappingURL=connect.js.map